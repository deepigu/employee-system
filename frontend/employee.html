<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Employee Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f4f8;
      color: #2c3e50;
      margin: 0;
      padding: 0;
    }
    .container {
      width: 400px;
      margin: 50px auto;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    header h1 {
      text-align: center;
      color: #1abc9c;
    }
    header label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
      margin-bottom: 5px;
    }
    header input {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #bdc3c7;
      border-radius: 5px;
    }
    .buttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 20px;
    }
    .btn {
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      color: #fff;
      transition: 0.2s;
    }
    .buttons {
  display: grid;
  grid-template-columns: 1fr 1fr; /* two columns */
  gap: 10px;
  margin-top: 20px;
}

    .clock-in { background-color: #27ae60; }
    .clock-in:hover { background-color: #2ecc71; }
    .break-start { background-color: #f39c12; }
    .break-start:hover { background-color: #f1c40f; }
    .break-end { background-color: #e67e22; }
    .break-end:hover { background-color: #d35400; }
    .logout { background-color: #c0392b; }
    .logout:hover { background-color: #e74c3c; }
    .status {
      margin-top: 15px;
      font-weight: bold;
      text-align: center;
      color: #34495e;
    }
  </style>
</head>
<body>

<div class="container">
  <header>
    <h1>Employee Dashboard</h1>

    <label for="employeeIdInput">Employee ID:</label>
    <input type="text" id="employeeIdInput" placeholder="Enter Employee ID" />

    <label for="employeeNameInput">Name:</label>
    <input type="text" id="employeeNameInput" placeholder="Enter Name" />

    <p id="welcome"></p>
  </header>

  <main>
    <div class="buttons">
      <button class="btn clock-in" onclick="clockIn()">Clock In</button>
      <button class="btn break-start" onclick="startBreak()">Start Break</button>
      <button class="btn break-end" onclick="endBreak()">End Break</button>
      <button class="btn logout" onclick="logout()">Logout</button>
    </div>

    <p id="status" class="status"></p>
  </main>
</div>

<script>
const token = localStorage.getItem("token");

// Helper function to get employee info from inputs
function getEmployeeInfo() {
  const employee_id = document.getElementById("employeeIdInput").value.trim();
  const employee_name = document.getElementById("employeeNameInput").value.trim();
  return { employee_id, employee_name };
}

// Update welcome message
function updateWelcome() {
  const { employee_id, employee_name } = getEmployeeInfo();
  document.getElementById("welcome").innerText = 
    employee_id && employee_name ? `ID: ${employee_id} | Name: ${employee_name}` : "";
}

// Call on input change
document.getElementById("employeeIdInput").addEventListener("input", updateWelcome);
document.getElementById("employeeNameInput").addEventListener("input", updateWelcome);

// Generic function to send actions
async function sendAction(action) {
  const { employee_id, employee_name } = getEmployeeInfo();
  if (!employee_id || !employee_name) {
    alert("Please enter Employee ID and Name!");
    return;
  }

  const res = await fetch("http://localhost:3000/api/time", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": `Bearer ${token}`
    },
    body: JSON.stringify({ action, employee_id, employee_name })
  });

  const statusText = {
    "clock_in": "Clock In recorded!",
    "break_start": "Break started!",
    "break_end": "Break ended!",
    "logout": "Logged out!"
  };

  document.getElementById("status").innerText = `${statusText[action]} (${employee_name} | ${employee_id})`;
}

// Button functions
function clockIn() { sendAction("clock_in"); }
function startBreak() { sendAction("break_start"); }
function endBreak() { sendAction("break_end"); }
function logout() { 
  sendAction("logout").then(() => {
    localStorage.clear();
    window.location.href = "login.html";
  });
}
</script>

</body>
</html>
